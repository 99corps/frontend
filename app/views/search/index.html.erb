<section id="content" role="main" class="group search ancillary">
  <%= render partial: 'form' %>


  <div class="search-container group">
    <% if @all_results.any? %>
      <div id="all-results">
        <% if @all_results.any? %>
          <ul class="results-list internal-links">
            <%= render collection: @all_results[0,1], partial: "result" %>
          </ul>
        <% end %>
      </div>
    <% end %>
  </div>

  <div id="search-results-tabs">
    <% if [(@mainstream_results + @recommended_link_results), @detailed_guidance_results, @government_results].reject(&:blank?).count > 1 %>
      <nav class="js-tabs nav-tabs" role="navigation">
        <ul id="search-index-navigation">
          <% if (@mainstream_results + @recommended_link_results + @detailed_guidance_results).any? %>
            <li>
              <a href="#mainstream-results"><span class="counter"><%= (@mainstream_results + @detailed_guidance_results).length %></span> Services, information <br>and guidance</a>
            </li>
          <% end %>
          <% if @government_results.any? %>
            <li>
              <a href="#government-results"><span class="counter"><%= @government_results.length %></span> Policies, departments <br>and announcements</a>
            </li>
          <% end %>
        </ul>
      </nav>
    <% end %>

    <div class="search-container group js-tab-content tab-content">
      <% if @mainstream_results.any? or @recommended_link_results.any? %>
        <div id="mainstream-results" class="js-tab-pane tab-pane <%= (@mainstream_results + @recommended_link_results).length == 1 ? ' single-item-pane' : ''%>">
          <% if @mainstream_results.any? %>
            <ul class="results-list internal-links">
              <%= render collection: @mainstream_results[0,3], partial: "result" %>
            </ul>
          <% end %>
          <% if @recommended_link_results.any? %>
            <div class="recommended-links">
              <h2>Other sites that may be useful</h2>
              <ul class="results-list">
                <%= render collection: @recommended_link_results, partial: "result" %>
              </ul>
            </div>
          <% end %>
          <% if @mainstream_results.any? %>
            <ul class="results-list internal-links">
              <%= render collection: @mainstream_results[4, 50], partial: "result" %>
              <%= render collection: @detailed_guidance_results, partial: "result" %>
            </ul>
          <% end %>
        </div>
      <% end %>

      <% if @government_results.any? %>
        <div id="government-results" class="js-tab-pane tab-pane">
          <ul class="results-list">
            <%= render collection: @government_results, partial: "result" %>
          </ul>
        </div>
      <% end %>
    </div>
  </div>
</section>

<% content_for :extra_headers do %>
  <link rel="alternate" type="application/json" href="/api/search.json?q=<%= @search_term %>">
<% end %>

<% content_for :title, "#{@search_term} - Search - GOV.UK" %>
